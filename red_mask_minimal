#!/bin/bash
# Minimal Red Masking - Single-command execution
# Usage: ./red_mask_minimal <image_path> [output_name] [detection_prompt]

# Get current directory
DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" &> /dev/null && pwd )"

# Activate virtual environment if it exists
if [ -d "$DIR/venv_minimal" ]; then
    source "$DIR/venv_minimal/bin/activate"
elif [ -d "$DIR/comfyui_env" ]; then
    source "$DIR/comfyui_env/bin/activate"
fi

# Set default values
IMAGE_PATH="${1:-test.png}"
OUTPUT_NAME="${2:-red_masked}"
PROMPT="${3:-shirt}"

echo "üî¥ MINIMAL AI RED MASKING"
echo "=========================="
echo "Image: $IMAGE_PATH"
echo "Output: ${OUTPUT_NAME}.png"
echo "Detecting: $PROMPT"
echo ""

# Run the minimal AI detection
cd "$DIR"
python minimal_comfyui_detection.py "$IMAGE_PATH" -o "${OUTPUT_NAME}.png" -p "$PROMPT"

echo ""
echo "üìÅ Output saved in: output/${OUTPUT_NAME}.png"
